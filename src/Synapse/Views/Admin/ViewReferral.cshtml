@model Synapse.Data.ViewModels.ViewReferralVM

@{
    ViewData["Title"] = "ViewReferral";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <div class="container has-text-centered" style="width: 65%; margin-left: auto; margin-right: auto;">
        <div>
            <h1 class="title" style="font-weight: normal;">Viewing referral for <span class="has-text-weight-bold">@Html.DisplayFor(modelItem => Model.StudentFirstName) @Html.DisplayFor(modelItem => Model.StudentLastName)</span></h1>
            <h1 class="subtitle" style="font-weight: normal;">Issued on 
                <span class="has-text-weight-bold">@Html.DisplayFor(modelItem => Model.DateIssuedString)</span> 
                by 
                <span class="has-text-weight-bold">@Html.DisplayFor(modelItem => Model.TeacherFullName)</span>
            </h1>
            <h1 class="subtitle" style="font-weight: normal;">Description: 
                <span class="has-text-weight-bold">"@Html.DisplayFor(modelItem => Model.Description)"</span>
            </h1>

            <!--If the Referral has already been handled, don't display "Mark as Handled" button-->
            @if (!Model.Handled)
            {
                @using (Html.BeginForm("MarkAsHandled", "Admin", FormMethod.Post))
                {
                    <button class="button is-primary" type="submit" name="MarkAsHandledButton">
                        Mark as Handled
                    </button>
                    <input id="referralid" name="referralid" hidden value="@Model.ReferralId" />
                }
            }

            <hr />
        </div>
    </div>

    <div class= "container has-text-centered">
        <span class="title" style="font-weight: normal;">Other Referrals</span>
        <div class="is-centered">
            <table class="table" style="width: 65%; margin-left: auto; margin-right: auto">
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>Teacher Name</th>
                        <th>Date</th>
                        <th>Description</th>
                        <th>Handled</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var otherReferral in Model.OtherReferrals)
                    {
                        <tr>
                            <td>@Html.DisplayFor(modelItem => otherReferral.StudentFullName)</td>
                            <td>@Html.DisplayFor(modelItem => otherReferral.TeacherFullName)</td>
                            <td>@Html.DisplayFor(modelItem => otherReferral.DateIssuedString)</td>
                            <td>@Html.DisplayFor(modelItem => otherReferral.DescriptionTruncated)</td>
                            <td>@Html.DisplayFor(modelItem => otherReferral.Handled)</td>
                            <td>
                                <a asp-area="" asp-controller="Admin" asp-action="ViewReferral" asp-route-referralid=@otherReferral.ReferralId>
                                    <button class="button is-primary is-small">
                                        View
                                    </button>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>